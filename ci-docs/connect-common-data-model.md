---
title: Common Data Model қалтасын Azure Data Lake тіркелгісі көмегімен қосу
description: Azure Data Lake Storage арқылы Common Data Model деректерімен жұмыс істеңіз.
ms.date: 07/27/2022
ms.topic: how-to
author: mukeshpo
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-data-sources
- ci-create-data-source
- ci-attach-cdm
- customerInsights
ms.openlocfilehash: e071bf9364b44a92d81c9ff2269ff4e8654010aa
ms.sourcegitcommit: 5807b7d8c822925b727b099713a74ce2cb7897ba
ms.translationtype: MT
ms.contentlocale: kk-KZ
ms.lasthandoff: 07/28/2022
ms.locfileid: "9207006"
---
# <a name="connect-to-data-in-azure-data-lake-storage"></a>Azure Data Lake Storage ішінде деректерге қосылу

Деректерді енгізу Dynamics 365 Customer Insights пайдаланып Azure Data Lake Storage Gen2 тіркелгісі. Деректерді қабылдау толық немесе қосымша болуы мүмкін.

## <a name="prerequisites"></a>Алғышарттар

- Деректерді қабылдауды қолдайды Azure Data Lake Storage *Gen2* тек қана шоттар. Деректерді қабылдау үшін Data Lake Storage Gen1 тіркелгілерін пайдалана алмайсыз.

- The Azure Data Lake Storage шот болуы керек [иерархиялық аттар кеңістігі қосылды](/azure/storage/blobs/data-lake-storage-namespace). Деректер түбірлік қалтаны анықтайтын және әрбір нысан үшін ішкі қалталары бар иерархиялық қалта пішімінде сақталуы керек. Ішкі қалталарда толық деректер немесе қосымша деректер қалталары болуы мүмкін.

- Azure субъек-қызметімен аутентификациялау үшін оның қатысушыда конфигурацияланғандығына көз жеткізіңіз. Қосымша ақпаратты қараңыз [қосылыңыз Azure Data Lake Storage Azure қызмет көрсетушісімен Gen2 тіркелгісі](connect-service-principal.md).

- The Azure Data Lake Storage қосқыңыз және деректерді алғыңыз келсе, сол Azure аймағында болуы керек Dynamics 365 Customer Insights қоршаған орта. Common Data Model қалтасына деректер көлінен түрлі Azure аймағында қосу жүйелеріне қолдау көрсетілмейді. Ортаның көгілдір аймағын білу үшін мына мекенжайға өтіңіз **Админ** > **Жүйе** > **туралы** Customer Insights ішінде.

- Онлайн қызметтерде сақталған деректер деректер өңделетін немесе сақталатын жерден басқа жерде сақталуы мүмкін Dynamics 365 Customer Insights.Онлайн қызметтерде сақталған деректерді импорттау немесе оларға қосылу арқылы сіз деректерді тасымалдауға және сақтауға болатынына келісесіз Dynamics 365 Customer Insights . [Толығырақ Microsoft сенім орталығынан біліңіз](https://www.microsoft.com/trust-center).

- Сақтау тіркелгісіне кіру үшін Customer Insights қызметінің негізгі қызметкері келесі рөлдердің бірінде болуы керек. Қосымша ақпаратты қараңыз [Жад тіркелгісіне кіру үшін қызмет көрсетушіге рұқсаттар беріңіз](connect-service-principal.md#grant-permissions-to-the-service-principal-to-access-the-storage-account).
  - Сақтау орнының Blob деректерін оқу құралы
  - Сақтау орнының Blob деректерінің иеленушісі
  - Сақтау орнының Blob деректерін қосушы

- Деректер көлі қоймасындағы деректер деректеріңізді сақтауға арналған Common Data Model стандартына сәйкес болуы және деректер файлдарының схемасын (*.csv немесе *.parquet) көрсету үшін жалпы деректер үлгісінің манифестіне ие болуы керек. Манифест нысан бағандары мен деректер түрлері, деректер файлының орны мен файл түрі сияқты нысандардың мәліметтерін қамтамасыз етуі керек. Қосымша ақпаратты қараңыз [Жалпы деректер үлгісі манифесті](/common-data-model/sdk/manifest). Манифест жоқ болса, Storage Blob деректерінің иесі немесе Storage Blob деректер қатысушысы қатынасы бар әкімші пайдаланушылары деректерді қабылдау кезінде схеманы анықтай алады.

## <a name="connect-to-azure-data-lake-storage"></a>Azure Data Lake Storage бағдарламасына қосылу

1. **Деректер** > **Дерек көздері** тармағы бойынша өтіңіз.

1. **Деректер көзін қосу** түймешігін таңдаңыз.

1. таңдаңыз **Azure деректер көлінің қоймасы**.

   :::image type="content" source="media/data_sources_ADLS.png" alt-text="Azure Data Lake үшін қосылым мәліметтерін енгізу үшін диалогтық терезе." lightbox="media/data_sources_ADLS.png":::

1. А енгізіңіз **Аты** деректер көзі және қосымша үшін **Сипаттама**. Атау деректер көзі файлын бірегей түрде анықтайды және төменгі процестерде сілтеме жасалады және оны өзгерту мүмкін емес.

1. Келесі опциялардың бірін таңдаңыз **көмегімен жадты қосыңыз**. Қосымша ақпаратты қараңыз [Customer Insights қолданбасына қосыңыз Azure Data Lake Storage Azure қызмет көрсетушісімен Gen2 тіркелгісі](connect-service-principal.md).

   - **Azure ресурсы** : енгізіңіз **Ресурс идентификаторы** . Қосымша, Azure Private Link арқылы сақтау тіркелгісінен деректерді алғыңыз келсе, таңдаңыз **Жеке сілтемені қосыңыз**. Қосымша ақпаратты қараңыз [Жеке сілтемелер](security-overview.md#private-links-tab).
   - **Azure жазылымы** : таңдаңыз **Жазылым** содан кейін **Ресурстар тобы** және **Сақтау тіркелгісі**. Қосымша, Azure Private Link арқылы сақтау тіркелгісінен деректерді алғыңыз келсе, таңдаңыз **Жеке сілтемені қосыңыз**. Қосымша ақпаратты қараңыз [Жеке сілтемелер](security-overview.md#private-links-tab).
  
   > [!NOTE]
   > деректер көзі жасау үшін контейнерге немесе сақтау тіркелгісіне келесі рөлдердің бірі қажет:
   >
   >  - Storage Blob деректерін оқу құралы сақтау тіркелгісінен оқу және деректерді Customer Insights жүйесіне енгізу үшін жеткілікті. 
   >  - Манифест файлдарын тікелей Customer Insights қолданбасында өңдегіңіз келсе, сақтау блогы деректерінің қатысушысы немесе иесі қажет.  
  
1. атын таңдаңыз **Контейнер** деректер импорттау үшін деректер мен схеманы (model.json немесе manifest.json файлы) қамтитын және таңдаңыз.**Келесі**.
   > [!NOTE]
   > Ортадағы басқа деректер көзімен байланысты кез келген model.json немесе manifest.json файлы тізімде көрсетілмейді. Алайда, сол model.json немесе manifest.json файлын бірнеше ортадағы деректер көздері үшін пайдалануға болады.

1. Жаңа схеманы жасау үшін өтіңіз [Жаңа схема файлын жасаңыз](#create-a-new-schema-file).

1. Бар схеманы пайдалану үшін model.json немесе manifest.cdm.json файлы бар қалтаға өтіңіз. Файлды табу үшін каталог ішінде іздеуге болады.

1. Json файлын таңдап, таңдаңыз **Келесі**. Қол жетімді нысандар тізімі көрсетіледі.

   :::image type="content" source="media/review-entities.png" alt-text="Таңдалатын нысандар тізімінің диалогтық терезесі":::

1. Қосқыңыз келетін нысандарды таңдаңыз.

   :::image type="content" source="media/ADLS_required.png" alt-text="«Негізгі кілт үшін қажет» параметрін көрсететін диалогтық терезе":::

   > [!TIP]
   > JSON өңдеу интерфейсіндегі нысанды өңдеу үшін нысанды, содан кейін таңдаңыз **Схема файлын өңдеу**. Өзгерістерді енгізіп, таңдаңыз **Сақтау**.

1. Қосымша қабылдауды қажет ететін таңдалған нысандар үшін, **Міндетті** астында көрсетіледі **Қосымша жаңарту**. Осы нысандардың әрқайсысы үшін қараңыз [Azure Data Lake деректер көздері үшін қосымша жаңартуды теңшеңіз](incremental-refresh-data-sources.md).

1. Бастапқы кілт анықталмаған таңдалған нысандар үшін, **Міндетті** астында көрсетіледі **Негізгі кілт**. Осы нысандардың әрқайсысы үшін:
   1. таңдаңыз **Міндетті**. The **Нысанды өңдеу** панельдік дисплейлер.
   1. таңдаңыз **Негізгі кілт**. Бастапқы кілт нысанға ғана тән төлсипат болып табылады. Жарамды негізгі кілт болуы үшін төлсипат қайталанатын мәндерді, жетіспейтін мәндерді немесе бос мәндерді қамтымауы керек. Жол, бүтін және GUID деректер түрі атрибуттарына негізгі кілттер ретінде қолдау көрсетіледі.
   1. Қажет болса, бөлім үлгісін өзгертіңіз.
   1. таңдаңыз **Жабық** тақтаны сақтау және жабу үшін.

1. санын таңдаңыз **Атрибуттар** әрбір енгізілген нысан үшін. The **Атрибуттарды басқару** бетті көрсетеді.

   :::image type="content" source="media/dataprofiling-entities.png" alt-text="Деректер профилін таңдау үшін диалогтық терезе.":::

   1. Жаңа атрибуттарды жасаңыз, бар атрибуттарды өңдеңіз немесе жойыңыз. Атын, деректер пішімін өзгертуге немесе семантикалық түрді қосуға болады.
   1. Аналитика мен басқа мүмкіндіктерді қосу үшін таңдаңыз **Деректер профилін жасау** бүкіл нысан үшін немесе нақты атрибуттар үшін. Әдепкі бойынша, деректерді профильдеу үшін ешбір нысан қосылмаған.
   1. **Дайын** опциясын таңдаңыз.

1. **Сақтау** пәрменін таңдаңыз. The **Деректер көздері** жаңа деректер көзі көрсететін бет ашылады **Сергіту** күй.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

Деректерді жүктеу уақыт алуы мүмкін. Сәтті жаңартудан кейін енгізілген деректерді мына жерден қарап шығуға болады [**Субъектілер**](entities.md) бет.

### <a name="create-a-new-schema-file"></a>Жаңа схема файлын жасаңыз

1. таңдаңыз **Жаңа схема файлы**.

1. Файл атын енгізіп, таңдаңыз **Сақтау**.

1. таңдаңыз **Жаңа нысан**. The **Жаңа нысан** панельдік дисплейлер.

1. Нысан атын енгізіп, таңдаңыз **Деректер файлдарының орны**.
   - **Бірнеше .csv немесе .parquet файлдары** : Түбірлік қалтаны шолыңыз, үлгі түрін таңдап, өрнекті енгізіңіз.
   - **Жалғыз .csv немесе .parquet файлдары** : .csv немесе .parquet файлын шолып, оны таңдаңыз.

   :::image type="content" source="media/ADLS_new_entity_location.png" alt-text="Деректер файлдарының орны бөлектелген жаңа нысанды жасауға арналған диалогтық терезе.":::

1. **Сақтау** пәрменін таңдаңыз.

   :::image type="content" source="media/ADLS_new_entity_define_attributes.png" alt-text="Төлсипаттарды анықтау немесе автоматты түрде жасау үшін диалогтық терезе.":::

1. таңдаңыз **атрибуттарды анықтаңыз** атрибуттарды қолмен қосу үшін немесе таңдаңыз **оларды автоматты түрде жасау**. Атрибуттарды анықтау үшін атауды енгізіңіз, деректер пішімін және қосымша семантикалық түрін таңдаңыз. Автоматты түрде жасалған атрибуттар үшін:

   1. Атрибуттар автоматты түрде жасалғаннан кейін таңдаңыз **Атрибуттарды қарап шығу**. The **Атрибуттарды басқару** бетті көрсетеді.

   1. Әрбір төлсипат үшін деректер пішімі дұрыс екеніне көз жеткізіңіз.

   1. Аналитика мен басқа мүмкіндіктерді қосу үшін таңдаңыз **Деректер профилін жасау** бүкіл нысан үшін немесе нақты атрибуттар үшін. Әдепкі бойынша, деректерді профильдеу үшін ешбір нысан қосылмаған.

      :::image type="content" source="media/dataprofiling-entities.png" alt-text="Деректер профилін таңдау үшін диалогтық терезе.":::

   1. **Дайын** опциясын таңдаңыз. The **Нысандарды таңдаңыз** бетті көрсетеді.

1. Қажет болса, нысандар мен төлсипаттарды қосуды жалғастырыңыз.

1. Барлық нысандар қосылғаннан кейін таңдаңыз **Қосу** нысандарды деректер көзі қабылдауына қосу үшін.

   :::image type="content" source="media/ADLS_required.png" alt-text="«Негізгі кілт үшін қажет» параметрін көрсететін диалогтық терезе":::

1. Қосымша қабылдауды қажет ететін таңдалған нысандар үшін, **Міндетті** астында көрсетіледі **Қосымша жаңарту**. Осы нысандардың әрқайсысы үшін қараңыз [Azure Data Lake деректер көздері үшін қосымша жаңартуды теңшеңіз](incremental-refresh-data-sources.md).

1. Бастапқы кілт анықталмаған таңдалған нысандар үшін, **Міндетті** астында көрсетіледі **Негізгі кілт**. Осы нысандардың әрқайсысы үшін:
   1. таңдаңыз **Міндетті**. The **Нысанды өңдеу** панельдік дисплейлер.
   1. таңдаңыз **Негізгі кілт**. Бастапқы кілт нысанға ғана тән төлсипат болып табылады. Жарамды негізгі кілт болуы үшін төлсипат қайталанатын мәндерді, жетіспейтін мәндерді немесе бос мәндерді қамтымауы керек. Жол, бүтін және GUID деректер түрі атрибуттарына негізгі кілттер ретінде қолдау көрсетіледі.
   1. Қажет болса, бөлім үлгісін өзгертіңіз.
   1. таңдаңыз **Жабық** тақтаны сақтау және жабу үшін.

1. **Сақтау** пәрменін таңдаңыз. The **Деректер көздері** жаңа деректер көзі көрсететін бет ашылады **Сергіту** күй.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

Деректерді жүктеу уақыт алуы мүмкін. Сәтті жаңартудан кейін енгізілген деректерді мына жерден қарап шығуға болады [**Субъектілер**](entities.md) бет.

## <a name="edit-an-azure-data-lake-storage-data-source"></a>Өңдеу a Azure Data Lake Storage деректер көзі

жаңартуға болады *көмегімен жад тіркелгісіне қосылыңыз* опция. Қосымша ақпаратты қараңыз [Customer Insights қолданбасына қосыңыз Azure Data Lake Storage Azure қызмет көрсетушісімен Gen2 тіркелгісі](connect-service-principal.md). Сақтау орнының тіркелгісінен басқа контейнерге қосылу немесе тіркелгі атауын өзгерту үшін, [жаңа деректер көзі қосылымын жасау](#connect-to-azure-data-lake-storage) қажет.

1. **Деректер** > **Дерек көздері** тармағы бойынша өтіңіз.

1. Жаңартқыңыз келетін деректер көзі жанындағы таңдаңыз **Өңдеу**.

   :::image type="content" source="media/data_sources_edit_ADLS.png" alt-text="Azure Data Lake деректер көзі өңдеуге арналған диалогтық терезе.":::

1. Келесі ақпараттың кез келгенін өзгертіңіз:

   - **Сипаттама**
   - **көмегімен жадты қосыңыз** және қосылым туралы ақпарат. Байланысты жаңарту кезінде **Контейнер** ақпаратын өзгерту мүмкін емес.
      > [!NOTE]
      > Келесі рөлдердің бірі сақтау тіркелгісіне немесе контейнерге тағайындалуы керек:
        > - Сақтау орнының Blob деректерін оқу құралы
        > - Сақтау орнының Blob деректерінің иеленушісі
        > - Сақтау орнының Blob деректерін қосушы

   - **Жеке сілтемені қосыңыз** Azure Private Link арқылы сақтау тіркелгісінен деректерді алғыңыз келсе. Қосымша ақпаратты қараңыз [Жеке сілтемелер](security-overview.md#private-links-tab).

1. **Келесі** пәрменін таңдаңыз.
1. Төмендегілердің кез келгенін өзгертіңіз:
   - Контейнердегі нысандардың басқа жиыны бар басқа model.json немесе manifest.json файлына өтіңіз.
   - Қабылдауға қосымша нысандарды қосу үшін таңдаңыз **Жаңа нысан**.
   - Тәуелділіктер болмаса, кез келген таңдалған нысандарды жою үшін нысанды және таңдаңыз **Жою**.
      > [!IMPORTANT]
      > Егер бар model.json немесе manifest.json файлына және нысандар жиынтығына тәуелділіктер болса, сіз қате туралы хабарламаны көресіз және басқа model.json немесе manifest.json файлын таңдай алмайсыз. Model.json немесе manifest.json файлын өзгертпес бұрын осы тәуелділіктерді жойыңыз немесе тәуелділіктерді болдырмас үшін қолданғыңыз келетін model.json немесе manifest.json файлымен жаңа деректер көзін жасаңыз.
   - Деректер файлының орнын немесе негізгі кілтті өзгерту үшін таңдаңыз **Өңдеу**.
   - Қосымша қабылдау деректерін өзгерту үшін қараңыз [Azure Data Lake деректер көздері үшін қосымша жаңартуды теңшеңіз](incremental-refresh-data-sources.md).
   - .json файлындағы нысан атауына сәйкес келетін нысан атауын ғана өзгертіңіз.

     > [!NOTE]
     > Әрқашан Customer Insights жүйесіндегі нысан атауын енгізуден кейін model.json немесе manifest.json файлындағы нысан атауымен бірдей сақтаңыз. Customer Insights жүйесі әрбір жүйені жаңарту кезінде барлық нысан атауларын model.json немесе manifest.json арқылы тексереді. Нысан атауы Customer Insights ішінде немесе сыртында өзгертілсе, қате орын алады, себебі Customer Insights .json файлында жаңа нысан атауын таба алмайды. Егер енгізілген нысан атауы кездейсоқ өзгертілсе, .json файлындағы атқа сәйкестендіру үшін Customer Insights ішіндегі нысан атауын өңдеңіз.

1. таңдаңыз **Атрибуттар** атрибуттарды қосу немесе өзгерту немесе деректер профилін қосу үшін. Содан кейін **Дайын** түймешігін таңдаңыз.

1. басыңыз **Сақтау** өзгертулерді қолданып, параметріне оралу үшін **Деректер көздері** бет.

   [!INCLUDE [progress-details-include](includes/progress-details-pane.md)]

[!INCLUDE [footer-include](includes/footer-banner.md)]
